[manifest]
version = "1.0.0"
dump_lua = true
priority = 0

# This is a (likely god-awful) patch for generally fixing localization of my blinds as a stopgap until steamodded properly handles loc vars 
[[patches]]
[patches.pattern]
target = "functions/UI_definitions.lua"
pattern = "local loc_target = localize{type = 'raw_descriptions', key = blind_choice.config.key, set = 'Blind', vars = {localize(G.GAME.current_round.most_played_poker_hand, 'poker_hands')}}"
position = "after"
payload = '''
if blind_choice.config.key:find("^bl_mathbl") ~= nil then 
    local blind_obj = G.P_BLINDS[blind_choice.config.key]
    if blind_obj.loc_vars then
        local res = blind_obj.loc_vars(blind_obj) or {}
        loc_target = localize{type = 'raw_descriptions', key = blind_choice.config.key, set = 'Blind', vars = res.vars or {}}
    end
end
'''
match_indent = true
overwrite = false

# The Infinite - Ban retriggering of cards
[[patches]]
[patches.pattern]
target = "functions/state_events.lua"
pattern = "reps[#reps+1] = eval"
position = "at"
payload = '''
if G.GAME.blind.name == "bl_mathbl_infinite" and not G.GAME.blind.disabled then 
    G.GAME.blind:wiggle()
    G.GAME.blind.triggered = true
else 
    reps[#reps+1] = eval
end
'''
match_indent = true
overwrite = true